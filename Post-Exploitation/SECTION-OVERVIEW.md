# Post-Exploitation

After a successful exploitation of a target, the following items must be considered before continuing the attack.

1. Evasive Behaviors
2. Information Gathering
3. Persistance
4. Vulnerability Assessment
5. Privilege Escalation
6. Data Exfiltration

---

## Evasive Behaviors

If a skilled administrator monitors the systems, any change or even a single command could trigger an alarm. In many cases, access could be lost to the network, and then threat hunting begins. Additionally lost access to a host (that gets quarantined) or a user account (that gets temporarily disabled or the password changed) is likely.
Possible reason for getting caught are not thoroughly testing a payload, or running a command such as net user or whoami that is often monitored by EDR systems and flagged as anomalous activity.

---

## Information Gathering

After evasive behaviors, the next step is re-orienting with the new internal environment and what options are available. Therefore, in the Post-Exploitation stage, go through the Information Gathering and Vulnerability Assessment stages again.

Search and enumerate the local network and local services such as printers, database servers, virtualization services, etc.

---

## Persistance

Once an overview of the system is known, the immediate next step is maintaining access to the exploited host. This way, if the connection is interrupted, access is still available. This step is essential and often used as the first step before the Information Gathering and Pillaging stages.

Follow non-standardized sequences because each system is individually configured by a unique administrator who brings their own preferences and knowledge. It is recommended to work flexibly during this phase and adapt to the circumstances. For example, suppose the original exploit was a buffer overflow attack on a service that is likely to crash it, persistence to the system should be established as soon as possible to avoid having to attack the service multiple times. Often if the connection is lost, access to the system will not be possible in the same way.

---

## Vulnerability Assessment

If access has been persisted and a good overview of the system is known, the repetition for the Vulnerability Assessment stage is next. This will be conducted from inside the system, analyzing the information and prioritize it accordingly. The goal is the escalation of privileges (if not already in place).

---

## Privilege Escalation

Privilege escalation is significant, and in most cases, it represents a critical moment that can open many doors. Getting the highest possible privileges on the system or domain is often crucial. Therefore to get the privileges of the root (on Linux-based systems) or the domain administrator/local administrator/SYSTEM (on Windows-based systems) is optimal.

Remember that the escalation of privileges does not always have to occur locally on the system. Stored credentials obtained during the information gathering stage from other users who are members of a higher privileged group will also work. Exploiting these privileges to log in as another user is also part of privilege escalation because it can be used to escalate privileges (quickly) using the new set of credentials.

---

## Data Exfiltration

Attempt to transfer important information from the target system to attacker owned system. Security systems such as Data Loss Prevention (DLP) and Endpoint Detection and Response (EDR) help detect and prevent data exfiltration and can possibly cause issues. In addition to Network Monitoring, many companies use encryption on hard drives to prevent external parties from viewing such information.
